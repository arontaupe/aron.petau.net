<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.27.0 by Michael Rose
  Copyright 2013-2025 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->

<html lang="en-US" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>AIRASPI Build Log - Personal Website</title>
<meta name="description" content="Utilizing an edge TPU to build an edge device for image recognition and object detection">


  <meta name="author" content="Aron Petau">
  
  <meta property="article:author" content="Aron Petau">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Personal Website">
<meta property="og:title" content="AIRASPI Build Log">
<meta property="og:url" content="https://www.aron.petau.net/airaspi-build-log/">


  <meta property="og:description" content="Utilizing an edge TPU to build an edge device for image recognition and object detection">



  <meta property="og:image" content="https://www.aron.petau.net/assets/images/logo.png">





  <meta property="article:published_time" content="2024-01-30T00:00:00+01:00">






<link rel="canonical" href="https://www.aron.petau.net/airaspi-build-log/">












<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Personal Website Feed">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<style>
  
</style>

<!-- insert favicons. use https://realfavicongenerator.net/ -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide" dir="ltr">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/logo.png" alt="Aron Petau"></a>
        
        <a class="site-title" href="/">
          Aron Petau
          <span class="site-subtitle">Student in Design & Computation</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a
                href="/cv/"
                
                
              >My CV</a>
            </li><li class="masthead__menu-item">
              <a
                href="/about/"
                
                
              >About</a>
            </li><li class="masthead__menu-item">
              <a
                href="/archive/"
                
                
              >Recent Projects</a>
            </li><li class="masthead__menu-item">
              <a
                href="/tags/"
                
                
              >Posts by Tags</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      




  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/" itemprop="item"><span itemprop="name">Home</span></a>

          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        <li class="current">AIRASPI Build Log</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  



<div itemscope itemtype="http://schema.org/Person">
  
  

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://www.aron.petau.net/" itemprop="url"></a>
    </h3>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>

  
  

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://www.aron.petau.net/" itemprop="url"></a>
    </h3>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>

  
  

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://www.aron.petau.net/" itemprop="url"></a>
    </h3>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>

  
  

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://www.aron.petau.net/" itemprop="url"></a>
    </h3>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>

  
  

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://www.aron.petau.net/" itemprop="url"></a>
    </h3>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>

  
  

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://www.aron.petau.net/" itemprop="url"></a>
    </h3>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>

  
  

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://www.aron.petau.net/" itemprop="url"></a>
    </h3>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>

  
  

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://www.aron.petau.net/" itemprop="url"></a>
    </h3>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>

  
  

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://www.aron.petau.net/" itemprop="url"></a>
    </h3>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>

  
  

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://www.aron.petau.net/" itemprop="url"></a>
    </h3>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>

  
  

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://www.aron.petau.net/" itemprop="url"></a>
    </h3>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>

  
  

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://www.aron.petau.net/" itemprop="url"></a>
    </h3>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>

  
  

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://www.aron.petau.net/" itemprop="url"></a>
    </h3>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>

  
  

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://www.aron.petau.net/" itemprop="url"></a>
    </h3>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>

  
  

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://www.aron.petau.net/" itemprop="url"></a>
    </h3>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>

  
  

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://www.aron.petau.net/" itemprop="url"></a>
    </h3>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>

  
  

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://www.aron.petau.net/" itemprop="url"></a>
    </h3>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>

  
  

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://www.aron.petau.net/" itemprop="url"></a>
    </h3>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>

  
  

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://www.aron.petau.net/" itemprop="url"></a>
    </h3>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>

  
  

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://www.aron.petau.net/" itemprop="url"></a>
    </h3>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>

  
  

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://www.aron.petau.net/" itemprop="url"></a>
    </h3>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>

  
  

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://www.aron.petau.net/" itemprop="url"></a>
    </h3>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>

  
  

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://www.aron.petau.net/" itemprop="url"></a>
    </h3>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>

  
  

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://www.aron.petau.net/" itemprop="url"></a>
    </h3>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>

  
  

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://www.aron.petau.net/" itemprop="url"></a>
    </h3>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>

  
  

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://www.aron.petau.net/" itemprop="url"></a>
    </h3>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>

  
  

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://www.aron.petau.net/" itemprop="url"></a>
    </h3>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>

  
  

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://www.aron.petau.net/" itemprop="url"></a>
    </h3>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>

  
</div>


<div itemscope itemtype="https://schema.org/Person" class="h-card">
  
  <div class="author__avatar">
    <a href="https://www.aron.petau.net/">
      <img src="/assets/images/aron_headshot.jpeg" alt="Aron Petau" itemprop="image" class="u-photo">
    </a>
  </div>
  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://www.aron.petau.net/" itemprop="url">Aron Petau</a>
    </h3>
    
    <div class="author__bio p-note" itemprop="description">
      <p>(he/him) Cognitive Science, Software Engineering, 3D Modelling, Design &amp; Computation, Maker Education</p>

    </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
      <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
        <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name" class="p-locality">Berlin, Germany</span>
      </li>
      

      
      
      
      <li><a href="mailto:aron@petau.net" rel="nofollow noopener noreferrer me" ><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span
            class="label">Email</span></a></li>
      
      
      
      <li><a href="https://t.me/apetau" rel="nofollow noopener noreferrer me" 
          itemprop="sameAs" ><i class="fab fa-fw fa-telegram" aria-hidden="true"></i><span
            class="label">Telegram</span></a></li>
      
      
      
      <li><a href="https://github.com/arontaupe" rel="nofollow noopener noreferrer me" 
          itemprop="sameAs" ><i class="fab fa-fw fa-github" aria-hidden="true"></i><span
            class="label">GitHub</span></a></li>
      
      
      
      <li><a href="https://www.printables.com/social/97957-arontaupe/models" rel="nofollow noopener noreferrer me" 
          itemprop="sameAs" ><i class="fas fa-cubes" aria-hidden="true"></i><span
            class="label">Printables</span></a></li>
      
      
      
      <li><a href="https://mastodon.online/@reprintedAron" rel="nofollow noopener noreferrer me" 
          itemprop="sameAs" ><i class="fab fa-mastodon" aria-hidden="true"></i><span
            class="label">Mastodon</span></a></li>
      
      
      
      <li><a href="https://www.newpractice.net/author/aron-petau" rel="nofollow noopener noreferrer me" 
          itemprop="sameAs" ><i class="fas fa-university" aria-hidden="true"></i><span
            class="label">New Practice Network</span></a></li>
      
      
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>
  
    
      
      
      
      
    
      
      
      
      
    
    
      <nav class="nav__list">
  <h3 class="nav__title" style="padding-left: 0;">Topics</h3>
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle Menu</label>
  <ul class="nav__items">
    
      
      
        <li>
          
            <a href="/printing/"><span class="nav__sub-title">3D Printing</span></a>
          

          
        </li>
      
        <li>
          
            <a href="/philosophy/"><span class="nav__sub-title">Philosophy</span></a>
          

          
        </li>
      
        <li>
          
            <a href="/cad/"><span class="nav__sub-title">CAD and 3D design</span></a>
          

          
        </li>
      
        <li>
          
            <a href="/beacon/"><span class="nav__sub-title">Beacon: Decentralized Energy</span></a>
          

          
        </li>
      
        <li>
          
            <a href="/plastic-recycling/"><span class="nav__sub-title">Plastic Recycling</span></a>
          

          
        </li>
      
        <li>
          
            <a href="/ballpark/"><span class="nav__sub-title">Unity</span></a>
          

          
        </li>
      
        <li>
          
            <a href="/coding/"><span class="nav__sub-title">Coding Examples</span></a>
          

          
        </li>
      
        <li>
          
            <a href="/homebrew/"><span class="nav__sub-title">Brewing Beer</span></a>
          

          
        </li>
      
        <li>
          
            <a href="/chatbot/"><span class="nav__sub-title">Speech interfaces</span></a>
          

          
        </li>
      
        <li>
          
            <a href="/thesis/"><span class="nav__sub-title">Linguistic experiment</span></a>
          

          
        </li>
      
        <li>
          
            <a href="/iron-smelting/"><span class="nav__sub-title">Making Iron</span></a>
          

          
        </li>
      
        <li>
          
            <a href="/allei/"><span class="nav__sub-title">Online Accessibility</span></a>
          

          
        </li>
      
        <li>
          
            <a href="/tags/"><span class="nav__sub-title">All Projects by Tags</span></a>
          

          
        </li>
      
    
  </ul>
</nav>

    
  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="AIRASPI Build Log">
    <meta itemprop="description" content="Utilizing an edge TPU to build an edge device for image recognition and object detection">
    <meta itemprop="datePublished" content="2024-01-30T00:00:00+01:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">
            <a href="https://www.aron.petau.net/airaspi-build-log/" itemprop="url">AIRASPI Build Log
</a>
          </h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          16 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
        <h2 id="ai-raspi-build-log">AI-Raspi Build Log</h2>

<p>This should document the rough steps to recreate airaspi as I go along.</p>

<p>Rough Idea: Build an edge device with image recognition and object detection capabilites.<br />
It should be realtime, aiming for 30fps at 720p.<br />
Portability and usage at installations is a priority, so it has to function without active internet connection and be as small as possible.<br />
It would be a real Edge Device, with no computation happening in the cloud.</p>

<p>Inspo from: <a href="https://github.com/MauiJerry/Pose2Art">pose2art</a></p>

<p class="notice">work in progress</p>

<h2 id="hardware">Hardware</h2>

<ul>
  <li><a href="https://www.raspberrypi.com/products/raspberry-pi-5/">Raspberry Pi 5</a></li>
  <li><a href="https://www.raspberrypi.com/documentation/accessories/camera.html">Raspberry Pi Camera Module v1.3</a></li>
  <li><a href="https://www.raspberrypi.com/documentation/accessories/camera.html">Raspberry Pi GlobalShutter Camera</a></li>
  <li>2x CSI FPC Cable (needs one compact side to fit pi 5)</li>
  <li><a href="https://pineberrypi.com/products/hat-ai-for-raspberry-pi-5">Pineberry AI Hat (m.2 E key)</a></li>
  <li><a href="https://www.coral.ai/products/m2-accelerator-dual-edgetpu">Coral Dual Edge TPU (m.2 E key)</a></li>
  <li>Raspi Official 5A Power Supply</li>
  <li>Raspi active cooler</li>
</ul>

<h2 id="setup">Setup</h2>

<h3 id="most-important-sources-used">Most important sources used</h3>

<p><a href="https://www.coral.ai/docs/m2/get-started/#requirements">coral.ai</a>
<a href="https://www.jeffgeerling.com/blog/2023/pcie-coral-tpu-finally-works-on-raspberry-pi-5">Jeff Geerling</a>
<a href="https://docs.frigate.video">Frigate NVR</a></p>

<h3 id="raspberry-pi-os">Raspberry Pi OS</h3>

<p>I used the Raspberry Pi Imager to flash the latest Raspberry Pi OS Lite to a SD Card.</p>

<p class="notice">Needs to be Debian Bookworm.<br />
Needs to be the full arm64 image (with desktop), otherwise you will get into camera driver hell.</p>

<p>Settings applied:</p>

<ul>
  <li>used the default arm64 image (with desktop)</li>
  <li>enable custom settings:</li>
  <li>enable ssh</li>
  <li>set wifi country</li>
  <li>set wifi ssid and password</li>
  <li>set locale</li>
  <li>set hostname: airaspi</li>
</ul>

<h3 id="update">update</h3>

<p>This is always good practice on a fresh install. It takes quite long with the full os image.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt update <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>apt upgrade <span class="nt">-y</span> <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>reboot
</code></pre></div></div>

<h3 id="prep-system-for-coral">prep system for coral</h3>

<p>Thanks again @Jeff Geerling, this is completely out of my comfort zone, I rely on people writing solid tutorials like this one.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># check kernel version</span>
<span class="nb">uname</span> <span class="nt">-a</span>
</code></pre></div></div>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># modify config.txt</span>
<span class="nb">sudo </span>nano /boot/firmware/config.txt
</code></pre></div></div>

<p>While in the file, add the following lines:</p>

<div class="language-config highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">kernel</span>=<span class="n">kernel8</span>.<span class="n">img</span>
<span class="n">dtparam</span>=<span class="n">pciex1</span>
<span class="n">dtparam</span>=<span class="n">pciex1_gen</span>=<span class="m">2</span>
</code></pre></div></div>

<p>Save and reboot:</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>reboot
</code></pre></div></div>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># check kernel version again</span>
<span class="nb">uname</span> <span class="nt">-a</span>
</code></pre></div></div>

<ul>
  <li>should be different now, with a -v8 at the end</li>
</ul>

<p>edit /boot/firmware/cmdline.txt</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>nano /boot/firmware/cmdline.txt
</code></pre></div></div>

<ul>
  <li>add pcie_aspm=off before rootwait</li>
</ul>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>reboot
</code></pre></div></div>

<h3 id="change-device-tree">change device tree</h3>

<h4 id="wrong-device-tree">wrong device tree</h4>

<p>The script simply did not work for me.</p>

<p class="notice">maybe this script is the issue?
i will try again without it</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl https://gist.githubusercontent.com/dataslayermedia/714ec5a9601249d9ee754919dea49c7e/raw/32d21f73bd1ebb33854c2b059e94abe7767c3d7e/coral-ai-pcie-edge-tpu-raspberrypi-5-setup | sh
</code></pre></div></div>

<ul>
  <li>Yes it was the issue, wrote a comment about it on the gist
<a href="https://gist.github.com/dataslayermedia/714ec5a9601249d9ee754919dea49c7e?permalink_comment_id=4860232#gistcomment-4860232">comment</a></li>
</ul>

<p>What to do instead?</p>

<p>Here, I followed Jeff Geerling down to the T. Please refer to his tutorial for more information.</p>

<p class="notice">In the meantime the Script got updated and it is now recommended again.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Back up the current dtb</span>
<span class="nb">sudo cp</span> /boot/firmware/bcm2712-rpi-5-b.dtb /boot/firmware/bcm2712-rpi-5-b.dtb.bak

<span class="c"># Decompile the current dtb (ignore warnings)</span>
dtc <span class="nt">-I</span> dtb <span class="nt">-O</span> dts /boot/firmware/bcm2712-rpi-5-b.dtb <span class="nt">-o</span> ~/test.dts

<span class="c"># Edit the file</span>
nano ~/test.dts

<span class="c"># Change the line: msi-parent = &lt;0x2f&gt;; (under `pcie@110000`)</span>
<span class="c"># To: msi-parent = &lt;0x66&gt;;</span>
<span class="c"># Then save the file.</span>

<span class="c"># Recompile the dtb and move it back to the firmware directory</span>
dtc <span class="nt">-I</span> dts <span class="nt">-O</span> dtb ~/test.dts <span class="nt">-o</span> ~/test.dtb
<span class="nb">sudo mv</span> ~/test.dtb /boot/firmware/bcm2712-rpi-5-b.dtb
</code></pre></div></div>

<p class="notice">Note: msi- parent sems to carry the value &lt;0x2c&gt; nowadays, cost me a few hours.</p>

<h3 id="install-apex-driver">install apex driver</h3>

<p>following instructions from <a href="https://coral.ai/docs/m2/get-started#2a-on-linux">coral.ai</a></p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"deb https://packages.cloud.google.com/apt coral-edgetpu-stable main"</span> | <span class="nb">sudo tee</span> /etc/apt/sources.list.d/coral-edgetpu.list

curl https://packages.cloud.google.com/apt/doc/apt-key.gpg | <span class="nb">sudo </span>apt-key add -

<span class="nb">sudo </span>apt-get update

<span class="nb">sudo </span>apt-get <span class="nb">install </span>gasket-dkms libedgetpu1-std

<span class="nb">sudo </span>sh <span class="nt">-c</span> <span class="s2">"echo 'SUBSYSTEM==</span><span class="se">\"</span><span class="s2">apex</span><span class="se">\"</span><span class="s2">, MODE=</span><span class="se">\"</span><span class="s2">0660</span><span class="se">\"</span><span class="s2">, GROUP=</span><span class="se">\"</span><span class="s2">apex</span><span class="se">\"</span><span class="s2">' &gt;&gt; /etc/udev/rules.d/65-apex.rules"</span>

<span class="nb">sudo </span>groupadd apex

<span class="nb">sudo </span>adduser <span class="nv">$USER</span> apex
</code></pre></div></div>

<p>Verify with</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lspci <span class="nt">-nn</span> | <span class="nb">grep </span>089a
</code></pre></div></div>

<ul>
  <li>should display the connected tpu</li>
</ul>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>reboot
</code></pre></div></div>

<p>confirm with, if the output is not /dev/apex_0, something went wrong</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">ls</span> /dev/apex_0
</code></pre></div></div>

<h3 id="docker">Docker</h3>

<p>Install docker, use the official instructions for debian.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-fsSL</span> https://get.docker.com <span class="nt">-o</span> get-docker.sh
<span class="nb">sudo </span>sh get-docker.sh
</code></pre></div></div>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># add user to docker group</span>
<span class="nb">sudo </span>groupadd docker
<span class="nb">sudo </span>usermod <span class="nt">-aG</span> docker <span class="nv">$USER</span>
</code></pre></div></div>

<p class="notice">Probably a source with source .bashrc would be enough, but I rebooted anyways</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>reboot
</code></pre></div></div>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># verify with</span>
docker run hello-world
</code></pre></div></div>

<h3 id="set-docker-to-start-on-boot">set docker to start on boot</h3>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>systemctl <span class="nb">enable </span>docker.service
<span class="nb">sudo </span>systemctl <span class="nb">enable </span>containerd.service
</code></pre></div></div>

<h3 id="test-the-edge-tpu">Test the edge tpu</h3>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir </span>coraltest
<span class="nb">cd </span>coraltest
<span class="nb">sudo </span>nano Dockerfile
</code></pre></div></div>

<p>Into the new file, paste:</p>

<div class="language-Dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">FROM</span><span class="s"> debian:10</span>

<span class="k">WORKDIR</span><span class="s"> /home</span>
<span class="k">ENV</span><span class="s"> HOME /home</span>
<span class="k">RUN </span><span class="nb">cd</span> ~
<span class="k">RUN </span>apt-get update
<span class="k">RUN </span>apt-get <span class="nb">install</span> <span class="nt">-y</span> git nano python3-pip python-dev pkg-config wget usbutils curl

<span class="k">RUN </span><span class="nb">echo</span> <span class="s2">"deb https://packages.cloud.google.com/apt coral-edgetpu-stable main"</span> <span class="se">\
</span>| <span class="nb">tee</span> /etc/apt/sources.list.d/coral-edgetpu.list
<span class="k">RUN </span>curl https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add -
<span class="k">RUN </span>apt-get update
<span class="k">RUN </span>apt-get <span class="nb">install</span> <span class="nt">-y</span> edgetpu-examples
</code></pre></div></div>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># build the docker container</span>
docker build <span class="nt">-t</span> <span class="s2">"coral"</span> <span class="nb">.</span>
</code></pre></div></div>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># run the docker container</span>
docker run <span class="nt">-it</span> <span class="nt">--device</span> /dev/apex_0:/dev/apex_0 coral /bin/bash
</code></pre></div></div>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># run an inference example from within the container</span>
python3 /usr/share/edgetpu/examples/classify_image.py <span class="nt">--model</span> /usr/share/edgetpu/examples/models/mobilenet_v2_1.0_224_inat_bird_quant_edgetpu.tflite <span class="nt">--label</span> /usr/share/edgetpu/examples/models/inat_bird_labels.txt <span class="nt">--image</span> /usr/share/edgetpu/examples/images/bird.bmp
</code></pre></div></div>

<p>Here, you should see the inference results from the edge tpu with some confidence values.<br />
If it ain’t so, safest bet is a clean restart</p>

<h3 id="portainer">Portainer</h3>

<p class="notice">This is optional, gives you a browser gui for your various docker containers</p>

<p>Install portainer</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker volume create portainer_data
docker run <span class="nt">-d</span> <span class="nt">-p</span> 8000:8000 <span class="nt">-p</span> 9443:9443 <span class="nt">--name</span> portainer <span class="nt">--restart</span><span class="o">=</span>always <span class="nt">-v</span> /var/run/docker.sock:/var/run/docker.sock <span class="nt">-v</span> portainer_data:/data portainer/portainer-ce:latest
</code></pre></div></div>

<p>open portainer in browser and set admin password</p>

<ul>
  <li>should be available under <a href="https://airaspi.local:9443">https://airaspi.local:9443</a></li>
</ul>

<h3 id="vnc-in-raspi-config">vnc in raspi-config</h3>

<p class="notice">optional, useful to test your cameras on your headless device.
You could of course also attach a monitor, but i find this more convenient.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>raspi-config
</code></pre></div></div>

<p>– interface otions, enable vnc</p>

<h3 id="connect-through-vnc-viewer">connect through vnc viewer</h3>

<p>Install vnc viewer on mac.<br />
Use airaspi.local:5900 as address.</p>

<h3 id="working-docker-compose-for-frigate">working docker-compose for frigate</h3>

<p>Start this as a custom template in portainer.</p>

<p class="notice">Important: you need to change the paths to your own paths</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">version</span><span class="pi">:</span> <span class="s2">"</span><span class="s">3.9"</span>
<span class="na">services</span><span class="pi">:</span>
  <span class="na">frigate</span><span class="pi">:</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">frigate</span>
    <span class="na">privileged</span><span class="pi">:</span> <span class="no">true</span> <span class="c1"># this may not be necessary for all setups</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">unless-stopped</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">ghcr.io/blakeblackshear/frigate:stable</span>
    <span class="na">shm_size</span><span class="pi">:</span> <span class="s2">"</span><span class="s">64mb"</span> <span class="c1"># update for your cameras based on calculation above</span>
    <span class="na">devices</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">/dev/apex_0:/dev/apex_0</span> <span class="c1"># passes a PCIe Coral, follow driver instructions here https://coral.ai/docs/m2/get-started/#2a-on-linux</span>

    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">/etc/localtime:/etc/localtime:ro</span>
      <span class="pi">-</span> <span class="s">/home/aron/frigate/config.yml:/config/config.yml</span> <span class="c1"># replace with your config file</span>
      <span class="pi">-</span> <span class="s">/home/aron/frigate/storage:/media/frigate</span> <span class="c1"># replace with your storage directory</span>
      <span class="pi">-</span> <span class="na">type</span><span class="pi">:</span> <span class="s">tmpfs</span> <span class="c1"># Optional: 1GB of memory, reduces SSD/SD Card wear</span>
        <span class="na">target</span><span class="pi">:</span> <span class="s">/tmp/cache</span>
        <span class="na">tmpfs</span><span class="pi">:</span>
          <span class="na">size</span><span class="pi">:</span> <span class="m">1000000000</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">5000:5000"</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">8554:8554"</span> <span class="c1"># RTSP feeds</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">8555:8555/tcp"</span> <span class="c1"># WebRTC over tcp</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">8555:8555/udp"</span> <span class="c1"># WebRTC over udp</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="na">FRIGATE_RTSP_PASSWORD</span><span class="pi">:</span> <span class="s2">"</span><span class="s">******"</span>
</code></pre></div></div>

<h3 id="working-frigate-config-file">Working frigate config file</h3>

<p class="notice">Frigate wants this file wherever you specified earlier that it will be.<br />
This is necessary just once. Afterwards, you will be able to change the config in the gui.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">mqtt</span><span class="pi">:</span>
  <span class="na">enabled</span><span class="pi">:</span> <span class="s">False</span>

<span class="na">detectors</span><span class="pi">:</span>
  <span class="na">cpu1</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">cpu</span>
    <span class="na">num_threads</span><span class="pi">:</span> <span class="m">3</span>
  <span class="na">coral_pci</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">edgetpu</span>
    <span class="na">device</span><span class="pi">:</span> <span class="s">pci</span>

<span class="na">cameras</span><span class="pi">:</span>
  <span class="na">cam1</span><span class="pi">:</span> <span class="c1"># &lt;------ Name the camera</span>
    <span class="na">ffmpeg</span><span class="pi">:</span>
      <span class="na">hwaccel_args</span><span class="pi">:</span> <span class="s">preset-rpi-64-h264</span>
      <span class="na">inputs</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">path</span><span class="pi">:</span> <span class="s">rtsp://192.168.1.58:8900/cam1</span>
          <span class="na">roles</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="s">detect</span>
  <span class="na">cam2</span><span class="pi">:</span> <span class="c1"># &lt;------ Name the camera</span>
    <span class="na">ffmpeg</span><span class="pi">:</span>
      <span class="na">hwaccel_args</span><span class="pi">:</span> <span class="s">preset-rpi-64-h264</span>
      <span class="na">inputs</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">path</span><span class="pi">:</span> <span class="s">rtsp://192.168.1.58:8900/cam2</span>
          <span class="na">roles</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="s">detect</span>
    <span class="na">detect</span><span class="pi">:</span>
      <span class="na">enabled</span><span class="pi">:</span> <span class="s">True</span> <span class="c1"># &lt;---- disable detection until you have a working camera feed</span>
      <span class="na">width</span><span class="pi">:</span> <span class="m">1280</span> <span class="c1"># &lt;---- update for your camera's resolution</span>
      <span class="na">height</span><span class="pi">:</span> <span class="m">720</span> <span class="c1"># &lt;---- update for your camera's resolution</span>
</code></pre></div></div>

<h3 id="mediamtx">mediamtx</h3>

<p>install mediamtx, do not use the docker version, it will be painful</p>

<p class="notice">double check the chip architecture here, caused me some headache</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir </span>mediamtx
<span class="nb">cd </span>mediamtx
wget https://github.com/bluenviron/mediamtx/releases/download/v1.5.0/mediamtx_v1.5.0_linux_arm64v8.tar.gz

<span class="nb">tar </span>xzvf mediamtx_v1.5.0_linux_arm64v8.tar.gz <span class="o">&amp;&amp;</span> <span class="nb">rm </span>mediamtx_v1.5.0_linux_arm64v8.tar.gz
</code></pre></div></div>

<p>edit the mediamtx.yml file</p>

<h3 id="working-paths-section-in-mediamtxyml">working paths section in mediamtx.yml</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">paths</span><span class="pi">:</span>
 <span class="na">cam1</span><span class="pi">:</span>
   <span class="na">runOnInit</span><span class="pi">:</span> <span class="s">bash -c 'rpicam-vid -t 0 --camera 0 --nopreview --codec yuv420 --width 1280 --height 720 --inline --listen -o - | ffmpeg -f rawvideo -pix_fmt yuv420p -s:v 1280x720 -i /dev/stdin -c:v libx264 -preset ultrafast -tune zerolatency -f rtsp rtsp://localhost:$RTSP_PORT/$MTX_PATH'</span>
   <span class="na">runOnInitRestart</span><span class="pi">:</span> <span class="s">yes</span>
 <span class="na">cam2</span><span class="pi">:</span>
   <span class="na">runOnInit</span><span class="pi">:</span> <span class="s">bash -c 'rpicam-vid -t 0 --camera 1 --nopreview --codec yuv420 --width 1280 --height 720 --inline --listen -o - | ffmpeg -f rawvideo -pix_fmt yuv420p -s:v 1280x720 -i /dev/stdin -c:v libx264 -preset ultrafast -tune zerolatency -f rtsp rtsp://localhost:$RTSP_PORT/$MTX_PATH'</span>
   <span class="na">runOnInitRestart</span><span class="pi">:</span> <span class="s">yes</span>
</code></pre></div></div>

<p>also change rtspAddress: :8554<br />
to rtspAddress: :8900<br />
Otherwise there is a conflict with frigate.</p>

<p>With this, you should be able to start mediamtx.</p>

<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./mediamtx
</code></pre></div></div>

<p>If there is no error, you can verify your stream through vlc under rtsp://airaspi.local:8900/cam1 (default would be 8554, but we changed it in the config file)</p>

<h3 id="current-status">Current Status</h3>

<p>I get working streams from both cameras, sending them out at 30fps at 720p.
frigate, however limits the display fps to 5, which is depressing to watch, especially since the tpu doesnt even break a little sweat.</p>

<p>Frigate claime that the TPU is good for up to 10 cameras, so there is headroom.</p>

<p>The stram is completely errant and drops frames left and right. I have sometimes seen detect fps of 0.2, but the TPU speed should definitely not be the bottleneck here. Maybe attach the cameras to a separate device and stream from there?</p>

<p>The biggest issue here is that the google folx seems to have abandoned the coral, even though they just released a new piece of hardware for it.
Their most RECENT python build is 3.9.
Specifically, pycoral seems to be the problem there. without a decent update, I will be confined to debian 10, with python 3.7.3.
That sucks.
There are custom wheels, but nothing that seems plug and play.</p>

<p>About the rest of this setup:
The decision to go for m.2 E key to save money, instead of spending more on the usb version was a huge mistake.
Please do yourself a favor and spend the extra 40 bucks.
Technically, its probably faster and better with continuous operation, but i have yet to feel the benefit of that.</p>

<h3 id="todos">TODOs</h3>

<ul>
  <li>add images and screenshots to the build log</li>
  <li>Check whether vdo.ninja is a viable way to add mobile streams. then Smartphone stream evaluation would be on the horizon.</li>
  <li>Bother the mediamtx makers about the libcamera bump, so we can get rid of the rpicam-vid hack.
I suspect there is quirte a lot of performance lost there.</li>
  <li>tweak the frigate config to get snapshots and maybe build an image / video database to later train a custom model.</li>
  <li>worry about attaching an external ssd and saving the video files on it.</li>
  <li>find a way to export the landmark points from frigate. maybe send them via osc like in pose2art?</li>
  <li>find a different hat that lets me access the other TPU? I have the dual version, but can currently only acces 1 of the 2 TPUs due to hardware restrictions.</li>
</ul>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#coral" class="page__taxonomy-item p-category" rel="tag">coral</a><span class="sep">, </span>
    
      <a href="/tags/#docker" class="page__taxonomy-item p-category" rel="tag">docker</a><span class="sep">, </span>
    
      <a href="/tags/#edge-computing" class="page__taxonomy-item p-category" rel="tag">edge computing</a><span class="sep">, </span>
    
      <a href="/tags/#edge-tpu" class="page__taxonomy-item p-category" rel="tag">edge TPU</a><span class="sep">, </span>
    
      <a href="/tags/#frigate" class="page__taxonomy-item p-category" rel="tag">frigate</a><span class="sep">, </span>
    
      <a href="/tags/#local-ai" class="page__taxonomy-item p-category" rel="tag">local AI</a><span class="sep">, </span>
    
      <a href="/tags/#private" class="page__taxonomy-item p-category" rel="tag">private</a><span class="sep">, </span>
    
      <a href="/tags/#raspberry-pi" class="page__taxonomy-item p-category" rel="tag">raspberry pi</a><span class="sep">, </span>
    
      <a href="/tags/#surveillance" class="page__taxonomy-item p-category" rel="tag">surveillance</a>
    
    </span>
  </p>




        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2024-01-30T00:00:00+01:00">January 30, 2024</time></p>

      </footer>

      

      
  <nav class="pagination">
    
      <a href="/commoning-cars/" class="pagination--pager" title="Commoning Cars">Previous</a>
    
    
      <a href="/local-diffusion/" class="pagination--pager" title="Local Diffusion">Next</a>
    
  </nav>


    </div>

    
  </article>

  
  
    
<div class="page__related">
  
  <h2 class="page__related-title">You May Also Enjoy</h2>
  <div class="grid__wrapper">
    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/masterthesis/puzzle.jpeg" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/master-thesis/" rel="permalink">Master’s Thesis
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Human - Waste: A thesis examining interactive workshops
</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/k%C3%A4sewerkstatt/cheese.jpeg" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/k%C3%A4sewerkstatt/" rel="permalink">Käsewerkstatt
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          4 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Building a Food trailer and selling my first Food
</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/echoing_dimensions/Echoing%20Dimensions-4.jpg" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/echoing-dimensions/" rel="permalink">Echoing Dimensions
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          6 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">An interactive audiovisual installation.
</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/local-diffusion/local-diffusion.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/local-diffusion/" rel="permalink">Local Diffusion
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          4 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Empower your own Stable Diffusion Generation: InKüLe supported student workshop: Local Diffusion by Aron Petau
</p>
  </article>
</div>

    
  </div>
</div>

  
  
</div>

      
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->


<!-- end custom footer snippets -->
        <div class="page__footer-follow">
    <ul class="social-icons">
        

        
        
        
        <li><a href="https://github.com/arontaupe" rel="nofollow noopener noreferrer"><i
                    class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
        
        
        <li><a href="https://www.printables.com/social/97957-arontaupe/models" rel="nofollow noopener noreferrer"><i
                    class="fas fa-fw fa-cubes" aria-hidden="true"></i> Printables</a></li>
        
        
        
        <li><a href="https://mastodon.online/@reprintedAron" rel="nofollow noopener noreferrer"><i
                    class="fab fa-fw fa-mastodon" aria-hidden="true"></i> Mastodon</a></li>
        
        
        
        <li><a href="https://www.etsy.com/de-en/shop/reprintedservices" rel="nofollow noopener noreferrer"><i
                    class="fab fa-fw fa-etsy" aria-hidden="true"></i> Storefront</a></li>
        
        
        
        <li><a href="/privacy/" rel="nofollow noopener noreferrer"><i
                    class="fas fa-fw fa-user-secret" aria-hidden="true"></i> Privacy Statement</a></li>
        
        
        

        
        <li><a
                href="/feed.xml"><i
                    class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
        

    </ul>
</div>
<div id="wcb" class="carbonbadge wcb-d"></div>
<div class="page__footer-copyright">&copy; 2025 Aron Petau</div>


<div id="wcb" class="carbonbadge wcb-d"></div>
<script src="https://unpkg.com/website-carbon-badges@1.1.3/b.min.js" defer></script>
      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>






  </body>
</html>
